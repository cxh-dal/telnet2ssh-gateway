# Telnet to SSH Proxy

ğŸ”’ å°†SSHè¿æ¥é€æ˜ä»£ç†åˆ°Telnetåç«¯è®¾å¤‡çš„å®‰å…¨è§£å†³æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

Telnet to SSH Proxy æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ä»£ç†æœåŠ¡ï¼Œå®ƒå…è®¸ç”¨æˆ·é€šè¿‡å®‰å…¨çš„SSHåè®®è¿æ¥åˆ°åªæ”¯æŒTelnetçš„è®¾å¤‡ã€‚è¯¥é¡¹ç›®è§£å†³äº†ç½‘ç»œå®‰å…¨è¦æ±‚ç¦æ­¢æ˜æ–‡åè®®ï¼Œä½†è®¾å¤‡ä¸æ”¯æŒSSHçš„é—®é¢˜ã€‚

### âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ”„ **å®æ—¶åŒå‘é€æ˜è½¬å‘**: SSHå’ŒTelnetä¼šè¯æ•°æ®æ— ç¼æµåŠ¨ï¼Œæ”¯æŒæ‰€æœ‰æ§åˆ¶å­—ç¬¦å’ŒåŸå§‹å­—èŠ‚æ•°æ®
- ğŸš€ **é«˜å¹¶å‘å’Œç¨³å®šæ€§**: æ”¯æŒå¤šç”¨æˆ·åŒæ—¶è¿æ¥ä¸åŒçš„Telnetåç«¯
- ğŸ”Œ **ç«¯å£æ˜ å°„**: åŸºäºç«¯å£çš„ä¸€å¯¹ä¸€æ˜ å°„ï¼Œé»˜è®¤æ”¯æŒ4001-4032å…±32ä¸ªç«¯å£
- ğŸ³ **Dockerå®¹å™¨åŒ–**: æä¾›å®Œæ•´çš„Dockeréƒ¨ç½²æ–¹æ¡ˆï¼Œä¸€é”®å¯åŠ¨
- ğŸ› ï¸ **ä¾¿æ·ç®¡ç†**: æä¾›å‘½ä»¤è¡Œå·¥å…·ç®¡ç†ç«¯å£æ˜ å°„
- ğŸ’š **å¥åº·æ£€æŸ¥**: å†…ç½®å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯åŠŸèƒ½
- ğŸ†“ **å¼€æºå…è´¹**: MITè®¸å¯è¯ï¼Œå¯å•†ä¸šä½¿ç”¨

## ğŸ—ï¸ æ¶æ„è¯´æ˜

```
ç”¨æˆ· (SSHå®¢æˆ·ç«¯)  <--SSHåŠ å¯†-->  ä»£ç†æœåŠ¡å™¨  <--Telnetæ˜æ–‡-->  åç«¯è®¾å¤‡
                              (ç«¯å£4001-4032)              (Telnetè®¾å¤‡)
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Docker 20.10+
- Docker Compose 1.29+

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd telnet-ssh-proxy
```

2. **é…ç½®ç«¯å£æ˜ å°„**

ç¼–è¾‘ `config.yaml` æ–‡ä»¶ï¼Œé…ç½®æ‚¨çš„ç«¯å£æ˜ å°„ï¼š

```yaml
mappings:
  4001:
    host: "192.168.1.100"  # Telnetè®¾å¤‡IP
    port: 23                # Telnetç«¯å£
    enabled: true           # å¯ç”¨æ­¤æ˜ å°„
    description: "äº¤æ¢æœº1"
  4002:
    host: "192.168.1.101"
    port: 23
    enabled: true
    description: "è·¯ç”±å™¨1"
```

æˆ–ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·é…ç½®ï¼š

```bash
# æ·»åŠ æ˜ å°„
python manage.py add 4001 192.168.1.100 23 --description "äº¤æ¢æœº1"

# æŸ¥çœ‹æ‰€æœ‰æ˜ å°„
python manage.py list
```

3. **å¯åŠ¨æœåŠ¡**

```bash
./start.sh
```

æˆ–æ‰‹åŠ¨å¯åŠ¨ï¼š

```bash
docker-compose up -d --build
```

4. **éªŒè¯æœåŠ¡**

```bash
# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
docker ps

# æŸ¥çœ‹æ—¥å¿—
docker logs -f telnet-ssh-proxy

# å¥åº·æ£€æŸ¥
docker exec telnet-ssh-proxy python health_check.py
```

## ğŸ“– ä½¿ç”¨è¯´æ˜

### è¿æ¥åˆ°ä»£ç†æœåŠ¡

ä½¿ç”¨ä»»ä½•SSHå®¢æˆ·ç«¯è¿æ¥åˆ°é…ç½®çš„ç«¯å£ï¼š

```bash
# ä½¿ç”¨SSHè¿æ¥ (é»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ ritts)
ssh -p 4001 ritts@your-proxy-server-ip

# æˆ–ä½¿ç”¨å¯†ç å‚æ•°
sshpass -p ritts ssh -p 4001 ritts@your-proxy-server-ip
```

è¿æ¥æˆåŠŸåï¼Œæ‚¨å°†è‡ªåŠ¨è¿æ¥åˆ°é…ç½®çš„Telnetåç«¯è®¾å¤‡ã€‚

### ç®¡ç†ç«¯å£æ˜ å°„

ä½¿ç”¨ `manage.py` è„šæœ¬ç®¡ç†ç«¯å£æ˜ å°„ï¼š

```bash
# åœ¨å®¹å™¨å†…æ‰§è¡Œ
docker exec telnet-ssh-proxy python manage.py [command]

# æˆ–ç›´æ¥åœ¨å®¿ä¸»æœºæ‰§è¡Œ
python manage.py [command]
```

#### å¯ç”¨å‘½ä»¤

**åˆ—å‡ºæ‰€æœ‰æ˜ å°„**
```bash
python manage.py list
```

**æ·»åŠ /æ›´æ–°æ˜ å°„**
```bash
python manage.py add <SSHç«¯å£> <Telnetä¸»æœº> <Telnetç«¯å£> --description "æè¿°"

# ç¤ºä¾‹
python manage.py add 4001 192.168.1.100 23 --description "äº¤æ¢æœº1"
```

**æŸ¥çœ‹æ˜ å°„è¯¦æƒ…**
```bash
python manage.py show 4001
```

**å¯ç”¨æ˜ å°„**
```bash
python manage.py enable 4001
```

**ç¦ç”¨æ˜ å°„**
```bash
python manage.py disable 4001
```

**åˆ é™¤æ˜ å°„**
```bash
python manage.py remove 4001
```

### é…ç½®æ–‡ä»¶è¯´æ˜

`config.yaml` ä¸»è¦é…ç½®é¡¹ï¼š

```yaml
# SSHæœåŠ¡å™¨é…ç½®
ssh:
  host: "0.0.0.0"           # ç›‘å¬åœ°å€
  username: "ritts"         # SSHç”¨æˆ·å
  password: "ritts"         # SSHå¯†ç 
  host_key: "/app/data/ssh_host_key"  # SSHä¸»æœºå¯†é’¥è·¯å¾„

# ç«¯å£æ˜ å°„é…ç½®
mappings:
  4001:                      # SSHç›‘å¬ç«¯å£
    host: "192.168.1.100"    # Telnetç›®æ ‡åœ°å€
    port: 23                 # Telnetç›®æ ‡ç«¯å£
    enabled: true            # æ˜¯å¦å¯ç”¨
    description: "è®¾å¤‡1"     # æè¿°ä¿¡æ¯

# æ—¥å¿—é…ç½®
logging:
  level: "INFO"                        # æ—¥å¿—çº§åˆ«
  file: "/app/logs/proxy.log"          # æ—¥å¿—æ–‡ä»¶
  max_bytes: 10485760                  # å•ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°(10MB)
  backup_count: 5                      # ä¿ç•™æ—¥å¿—æ–‡ä»¶æ•°é‡

# å¥åº·æ£€æŸ¥é…ç½®
health_check:
  enabled: true              # å¯ç”¨å¥åº·æ£€æŸ¥
  interval: 30               # æ£€æŸ¥é—´éš”(ç§’)
  timeout: 5                 # è¶…æ—¶æ—¶é—´(ç§’)
```

## ğŸ”§ é«˜çº§é…ç½®

### ä¿®æ”¹SSHè®¤è¯

ç¼–è¾‘ `config.yaml`:

```yaml
ssh:
  username: "your_username"
  password: "your_password"
```

### è‡ªå®šä¹‰ç«¯å£èŒƒå›´

å¦‚éœ€ä½¿ç”¨4001-4032ä¹‹å¤–çš„ç«¯å£ï¼Œéœ€è¦ï¼š

1. ä¿®æ”¹ `config.yaml` æ·»åŠ æ–°ç«¯å£é…ç½®
2. ä¿®æ”¹ `docker-compose.yml` æš´éœ²æ–°ç«¯å£
3. é‡å¯æœåŠ¡

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker logs -f telnet-ssh-proxy

# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f logs/proxy.log
```

### æŒä¹…åŒ–æ•°æ®

æ•°æ®å’Œæ—¥å¿—é€šè¿‡Dockerå·æŒ‚è½½åˆ°å®¿ä¸»æœºï¼š

- `./data` - SSHä¸»æœºå¯†é’¥ç­‰æ•°æ®
- `./logs` - æ—¥å¿—æ–‡ä»¶

## ğŸ” æ•…éšœæ’æŸ¥

### æœåŠ¡æ— æ³•å¯åŠ¨

1. æ£€æŸ¥Dockerå’ŒDocker Composeæ˜¯å¦æ­£ç¡®å®‰è£…
2. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š`netstat -tuln | grep 400`
3. æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker logs telnet-ssh-proxy`

### æ— æ³•è¿æ¥åˆ°SSHç«¯å£

1. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
2. ç¡®è®¤ç«¯å£æ˜ å°„å·²å¯ç”¨ï¼š`python manage.py list`
3. æ£€æŸ¥Telnetåç«¯æ˜¯å¦å¯è¾¾ï¼š`telnet <backend-ip> 23`

### è¿æ¥åæ— å“åº”

1. æ£€æŸ¥Telnetåç«¯è®¾å¤‡æ˜¯å¦æ­£å¸¸
2. æŸ¥çœ‹ä»£ç†æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯
3. éªŒè¯ç½‘ç»œè¿é€šæ€§

### å¥åº·æ£€æŸ¥å¤±è´¥

```bash
# æ‰‹åŠ¨æ‰§è¡Œå¥åº·æ£€æŸ¥
docker exec telnet-ssh-proxy python health_check.py

# æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯
docker logs telnet-ssh-proxy | grep -i error
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å¥åº·æ£€æŸ¥

Dockerè‡ªåŠ¨æ‰§è¡Œå¥åº·æ£€æŸ¥ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹ï¼š

```bash
# æŸ¥çœ‹å®¹å™¨å¥åº·çŠ¶æ€
docker ps

# æ‰‹åŠ¨æ‰§è¡Œå¥åº·æ£€æŸ¥
docker exec telnet-ssh-proxy python health_check.py
```

### é‡å¯ç­–ç•¥

Docker Composeé…ç½®ä¸º `restart: unless-stopped`ï¼ŒæœåŠ¡å¼‚å¸¸æ—¶ä¼šè‡ªåŠ¨é‡å¯ã€‚

### æ—¥å¿—è½®è½¬

æ—¥å¿—è‡ªåŠ¨è½®è½¬ï¼Œå•ä¸ªæ–‡ä»¶æœ€å¤§10MBï¼Œä¿ç•™5ä¸ªå†å²æ–‡ä»¶ã€‚

## ğŸ—ï¸ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œä»£ç†æœåŠ¡
python proxy_server.py

# è¿è¡Œç®¡ç†å·¥å…·
python manage.py list
```

### é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ proxy_server.py      # ä¸»ä»£ç†æœåŠ¡å™¨
â”œâ”€â”€ manage.py            # ç®¡ç†å·¥å…·
â”œâ”€â”€ health_check.py      # å¥åº·æ£€æŸ¥è„šæœ¬
â”œâ”€â”€ config.yaml          # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt     # Pythonä¾èµ–
â”œâ”€â”€ Dockerfile           # Dockeré•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml   # Docker Composeé…ç½®
â”œâ”€â”€ start.sh             # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop.sh              # åœæ­¢è„šæœ¬
â”œâ”€â”€ LICENSE              # MITè®¸å¯è¯
â””â”€â”€ README.md            # æœ¬æ–‡ä»¶
```

### æŠ€æœ¯æ ˆ

- **Python 3.11**: ä¸»è¦ç¼–ç¨‹è¯­è¨€
- **Paramiko**: SSHæœåŠ¡å™¨å®ç°
- **PyYAML**: é…ç½®æ–‡ä»¶è§£æ
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## âš ï¸ å®‰å…¨è¯´æ˜

1. **ä¿®æ”¹é»˜è®¤å¯†ç **: ç”Ÿäº§ç¯å¢ƒè¯·åŠ¡å¿…ä¿®æ”¹é»˜è®¤çš„SSHç”¨æˆ·åå’Œå¯†ç 
2. **ç½‘ç»œéš”ç¦»**: å»ºè®®å°†ä»£ç†æœåŠ¡éƒ¨ç½²åœ¨å®‰å…¨çš„ç½‘ç»œåŒºåŸŸ
3. **æ—¥å¿—å®¡è®¡**: å®šæœŸæ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼Œç›‘æ§å¼‚å¸¸è®¿é—®
4. **æœ€å°æƒé™**: ä»…å¯ç”¨éœ€è¦çš„ç«¯å£æ˜ å°„
5. **æ›´æ–°ç»´æŠ¤**: å®šæœŸæ›´æ–°ä¾èµ–åŒ…å’ŒDockeré•œåƒ

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueæˆ–è”ç³»ç»´æŠ¤è€…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºæ­¤é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

---

**æ³¨æ„**: Telnetæ˜¯æ˜æ–‡åè®®ï¼Œè¯·ç¡®ä¿ä»£ç†æœåŠ¡å™¨åˆ°Telnetè®¾å¤‡ä¹‹é—´çš„ç½‘ç»œæ˜¯å®‰å…¨å¯ä¿¡çš„ã€‚
